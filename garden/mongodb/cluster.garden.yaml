---
kind: Module
description: MongoDB cluster
type: kubernetes
name: mongodb-cluster
namespace: default
dependencies:
- mongodb-operator
manifests:
- apiVersion: mongodbcommunity.mongodb.com/v1
  kind: MongoDBCommunity
  metadata:
    name: mongodb
  spec:
    members: 1
    type: ReplicaSet
    version: "4.2.6"
    security:
      authentication:
        modes: [ "SCRAM" ]
    users:
    - name: root
      db: admin
      passwordSecretRef:
        name: mongodb-root-password
      roles:
      - name: clusterAdmin
        db: admin
      - name: userAdminAnyDatabase
        db: admin
      - name: readWriteAnyDatabase
        db: admin
      scramCredentialsSecretName: my-scram
    additionalMongodConfig:
      storage.wiredTiger.engineConfig.journalCompressor: zlib
-
  apiVersion: v1
  kind: Secret
  metadata:
    name: mongodb-root-password
  type: Opaque
  stringData:
    password: very-secured-password
